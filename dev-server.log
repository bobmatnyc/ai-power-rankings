
> ai-power-rankings@2.2.0 dev /Users/masa/Projects/ai-power-rankings
> node scripts/clear-next-cache.js && next dev

üßπ Clearing Next.js cache...
‚ÑπÔ∏è  No Next.js cache found
üîß Dynamic Environment Configuration:
   PORT: 3000
   NEXTAUTH_URL: Dynamic (via getUrl())
   NEXT_PUBLIC_PAYLOAD_URL: Dynamic (via getUrl())
üîß Dynamic Environment Configuration:
   PORT: 3000
   NEXTAUTH_URL: Dynamic (via getUrl())
   NEXT_PUBLIC_PAYLOAD_URL: Dynamic (via getUrl())
   ‚ñ≤ Next.js 15.3.3
   - Local:        http://localhost:3000
   - Network:      http://192.168.5.254:3000
   - Environments: .env.local

 ‚úì Starting...
 ‚úì Ready in 1177ms
 ‚óã Compiling /api/admin/ingest-news ...
 ‚úì Compiled /api/admin/ingest-news in 3.1s (2012 modules)
[13:42:15] [31mERROR[39m: [36mError running onInit function[39m
    err: {
      "type": "DrizzleQueryError",
      "message": "Failed query: select \"id\", \"name\", \"role\", \"auth_provider\", \"last_login_at\", \"apikey\", \"apikey_enabled\", \"updated_at\", \"created_at\", \"enable_a_p_i_key\", \"api_key\", \"api_key_index\", \"email\", \"reset_password_token\", \"reset_password_expiration\", \"salt\", \"hash\", \"login_attempts\", \"lock_until\" from \"payload\".\"users\" \"users\" order by \"users\".\"created_at\" desc limit $1\nparams: 1: column \"enable_a_p_i_key\" does not exist",
      "stack":
          Error: Failed query: select "id", "name", "role", "auth_provider", "last_login_at", "apikey", "apikey_enabled", "updated_at", "created_at", "enable_a_p_i_key", "api_key", "api_key_index", "email", "reset_password_token", "reset_password_expiration", "salt", "hash", "login_attempts", "lock_until" from "payload"."users" "users" order by "users"."created_at" desc limit $1
          params: 1
              at NodePgPreparedQuery.queryWithCache (webpack-internal:///(rsc)/./node_modules/.pnpm/drizzle-orm@0.44.2_@types+pg@8.10.2_pg@8.11.3/node_modules/drizzle-orm/pg-core/session.js:55:15)
              at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
              at async eval (webpack-internal:///(rsc)/./node_modules/.pnpm/drizzle-orm@0.44.2_@types+pg@8.10.2_pg@8.11.3/node_modules/drizzle-orm/node-postgres/session.js:131:22)
              at async find (webpack-internal:///(rsc)/./node_modules/.pnpm/@payloadcms+drizzle@3.43.0_@types+pg@8.10.2_payload@3.43.0_pg@8.11.3/node_modules/@payloadcms/drizzle/dist/find/findMany.js:123:21)
              at async findOperation (webpack-internal:///(rsc)/./node_modules/.pnpm/payload@3.43.0_graphql@16.11.0_typescript@5.8.3/node_modules/payload/dist/collections/operations/find.js:136:22)
              at async Object.onInit (webpack-internal:///(rsc)/./payload.config.ts:89:31)
              at async BasePayload.init (webpack-internal:///(rsc)/./node_modules/.pnpm/payload@3.43.0_graphql@16.11.0_typescript@5.8.3/node_modules/payload/dist/index.js:744:21)
              at async getPayload (webpack-internal:///(rsc)/./node_modules/.pnpm/payload@3.43.0_graphql@16.11.0_typescript@5.8.3/node_modules/payload/dist/index.js:871:26)
              at async POST (webpack-internal:///(rsc)/./src/app/api/admin/ingest-news/route.ts:116:25)
              at async AppRouteRouteModule.do (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:26:34112)
              at async AppRouteRouteModule.handle (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:26:41338)
              at async doRender (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:1518:42)
              at async DevServer.renderToResponseWithComponentsImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:1920:28)
              at async DevServer.renderPageComponent (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:2408:24)
              at async DevServer.renderToResponseImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:2445:32)
              at async DevServer.pipeImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:1008:25)
              at async NextNodeServer.handleCatchallRenderRequest (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/next-server.js:305:17)
              at async DevServer.handleRequestImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:900:17)
              at async /Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/dev/next-dev-server.js:371:20
              at async Span.traceAsyncFn (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/trace/trace.js:157:20)
              at async DevServer.handleRequest (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/dev/next-dev-server.js:368:24)
              at async invokeRender (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/router-server.js:237:21)
              at async handleRequest (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/router-server.js:428:24)
              at async requestHandlerImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/router-server.js:452:13)
              at async Server.requestListener (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/start-server.js:158:13)
          caused by: error: column "enable_a_p_i_key" does not exist
              at eval (webpack-internal:///(rsc)/./node_modules/.pnpm/pg-pool@3.10.1_pg@8.11.3/node_modules/pg-pool/index.js:45:11)
              at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
              at async eval (webpack-internal:///(rsc)/./node_modules/.pnpm/drizzle-orm@0.44.2_@types+pg@8.10.2_pg@8.11.3/node_modules/drizzle-orm/node-postgres/session.js:138:18)
              at async NodePgPreparedQuery.queryWithCache (webpack-internal:///(rsc)/./node_modules/.pnpm/drizzle-orm@0.44.2_@types+pg@8.10.2_pg@8.11.3/node_modules/drizzle-orm/pg-core/session.js:53:16)
              at async eval (webpack-internal:///(rsc)/./node_modules/.pnpm/drizzle-orm@0.44.2_@types+pg@8.10.2_pg@8.11.3/node_modules/drizzle-orm/node-postgres/session.js:131:22)
              at async find (webpack-internal:///(rsc)/./node_modules/.pnpm/@payloadcms+drizzle@3.43.0_@types+pg@8.10.2_payload@3.43.0_pg@8.11.3/node_modules/@payloadcms/drizzle/dist/find/findMany.js:123:21)
              at async findOperation (webpack-internal:///(rsc)/./node_modules/.pnpm/payload@3.43.0_graphql@16.11.0_typescript@5.8.3/node_modules/payload/dist/collections/operations/find.js:136:22)
              at async Object.onInit (webpack-internal:///(rsc)/./payload.config.ts:89:31)
              at async BasePayload.init (webpack-internal:///(rsc)/./node_modules/.pnpm/payload@3.43.0_graphql@16.11.0_typescript@5.8.3/node_modules/payload/dist/index.js:744:21)
              at async getPayload (webpack-internal:///(rsc)/./node_modules/.pnpm/payload@3.43.0_graphql@16.11.0_typescript@5.8.3/node_modules/payload/dist/index.js:871:26)
              at async POST (webpack-internal:///(rsc)/./src/app/api/admin/ingest-news/route.ts:116:25)
              at async AppRouteRouteModule.do (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:26:34112)
              at async AppRouteRouteModule.handle (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:26:41338)
              at async doRender (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:1518:42)
              at async DevServer.renderToResponseWithComponentsImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:1920:28)
              at async DevServer.renderPageComponent (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:2408:24)
              at async DevServer.renderToResponseImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:2445:32)
              at async DevServer.pipeImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:1008:25)
              at async NextNodeServer.handleCatchallRenderRequest (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/next-server.js:305:17)
              at async DevServer.handleRequestImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/base-server.js:900:17)
              at async /Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/dev/next-dev-server.js:371:20
              at async Span.traceAsyncFn (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/trace/trace.js:157:20)
              at async DevServer.handleRequest (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/dev/next-dev-server.js:368:24)
              at async invokeRender (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/router-server.js:237:21)
              at async handleRequest (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/router-server.js:428:24)
              at async requestHandlerImpl (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/router-server.js:452:13)
              at async Server.requestListener (/Users/masa/Projects/ai-power-rankings/node_modules/.pnpm/next@15.3.3_@babel+core@7.27.4_react-dom@19.1.0_react@19.1.0/node_modules/next/dist/server/lib/start-server.js:158:13)
      "query": "select \"id\", \"name\", \"role\", \"auth_provider\", \"last_login_at\", \"apikey\", \"apikey_enabled\", \"updated_at\", \"created_at\", \"enable_a_p_i_key\", \"api_key\", \"api_key_index\", \"email\", \"reset_password_token\", \"reset_password_expiration\", \"salt\", \"hash\", \"login_attempts\", \"lock_until\" from \"payload\".\"users\" \"users\" order by \"users\".\"created_at\" desc limit $1",
      "params": [
        1
      ]
    }
{"level":"ERROR","time":"2025-06-26T17:42:15.275Z","pid":14448,"hostname":"Masas-M4-Air.local","context":"API","msg":"News ingestion failed:"}
 POST /api/admin/ingest-news 500 in 4482ms
[error: {:shutdown, :db_termination}] {
  length: 56,
  severity: 'FATAL',
  code: 'XX000',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: undefined,
  line: undefined,
  routine: undefined,
  client: [Client]
}
 ‚®Ø uncaughtException: [error: {:shutdown, :db_termination}] {
  length: 56,
  severity: 'FATAL',
  code: 'XX000',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: undefined,
  line: undefined,
  routine: undefined,
  client: [Client]
}
 ‚®Ø uncaughtException:  [error: {:shutdown, :db_termination}] {
  length: 56,
  severity: 'FATAL',
  code: 'XX000',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: undefined,
  line: undefined,
  routine: undefined,
  client: [Client]
}
