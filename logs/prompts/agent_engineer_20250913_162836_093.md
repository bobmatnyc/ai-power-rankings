---
timestamp: 2025-09-13T16:28:36.093244
type: agent_engineer
metadata: {"agent_type": "engineer", "agent_id": "engineer_276ec092-ebfd-41f6-93cf-96266c20d590", "session_id": "276ec092-ebfd-41f6-93cf-96266c20d590", "delegation_context": {"description": "Build comprehensive article management", "timestamp": "2025-09-13T16:28:36.089155"}}
---


AGENT MEMORY - PROJECT-SPECIFIC KNOWLEDGE:
# Agent Memory: engineer
<!-- Last Updated: 2025-08-07 16:00:35 | Auto-updated by: engineer -->

<!-- MEMORY LIMITS: 8KB max | 10 sections max | 15 items per section -->

## Project Context
ai-power-rankings: node_js (with typescript, react) single page application
- Main modules: types, contexts, app, app/rss.xml
- Uses: @marsidev/react-turnstile, @radix-ui/react-checkbox, @radix-ui/react-collapsible
- Testing: @testing-library/jest-dom
- Key patterns: Async Programming

## Project Architecture
- Single Page Application with node_js implementation
- Main directories: src, docs
- Core modules: types, contexts, app, app/rss.xml

## Coding Patterns Learned
- Node.js project: use async/await, ES6+ features
- React patterns: component composition, hooks usage
- React patterns: component composition, hooks usage
- React patterns: component composition, hooks usage
- Project uses: Async Programming

## Implementation Guidelines
- Use pnpm for dependency management
- Write tests using @testing-library/jest-dom
- Use build tools: test, test:watch
- Key config files: package.json

## Domain-Specific Knowledge
<!-- Agent-specific knowledge for ai-power-rankings domain -->
- Key project terms: tools, about, rankings, admin
- Focus on implementation patterns, coding standards, and best practices
- Ensure test coverage using @testing-library/jest-dom

## Effective Strategies
<!-- Successful approaches discovered through experience -->

## Common Mistakes to Avoid
- Avoid callback hell - use async/await consistently
- Don't commit node_modules - ensure .gitignore is correct
- Don't skip test isolation - ensure tests can run independently

## Integration Points
- REST API integration pattern

## Performance Considerations
- Leverage event loop - avoid blocking operations
- Use streams for large data processing
- Use React.memo for expensive component renders

## Current Technical Context
- Tech stack: node_js, @marsidev/react-turnstile, @radix-ui/react-checkbox
- API patterns: REST API
- Key dependencies: @builder.io/partytown, @hookform/resolvers, @marsidev/react-turnstile, @next/third-parties
- Documentation: README.md, CHANGELOG.md, docs/SITEMAP-SUBMISSION.md

## Recent Learnings
<!-- Most recent discoveries and insights -->
- **August 2025 API Consolidation**: Reduced 8 separate endpoints to 1 unified handler
- **Code Reduction**: Achieved 30% reduction through aggressive refactoring
- **JSON Storage**: Standardized on file-based storage with validation
- **Cache Strategy**: Generate static JSON files for performance
- **TrackDown Integration**: All work must link to local tickets in /trackdown/


INSTRUCTIONS: Review your memory above before proceeding. Apply learned patterns and avoid known mistakes.


Build a comprehensive article management system with the following features:

## Requirements:

1. **Article Ingestion Methods**:
   - URL input (fetch and extract content)
   - Direct content input (paste text)
   - File upload (PDF, TXT, MD support)

2. **Dry Run Mode**:
   - Analyze content without saving
   - Extract and show: tags, tool mentions, company mentions
   - Calculate rankings changes (what would change and by how much)
   - Generate article summary
   - Return preview without database changes

3. **Complete Submission**:
   - Save article to database
   - Store original rankings snapshot before changes
   - Apply rankings changes to tools
   - Auto-create new tools/companies if mentioned but don't exist
   - Track which article caused which ranking changes

4. **Article Management**:
   - **Update**: Only changes article text/content, no rankings recalculation
   - **Recalculate**: Separate action to re-analyze and update rankings
   - **Delete**: Remove article AND rollback rankings to pre-article state
   - Keep tools/companies even if article that created them is deleted

5. **Database Schema Needs**:
   - Articles table with content, metadata, rankings_snapshot
   - Article_rankings_changes table to track what each article changed
   - Add created_by_article_id to tools and companies tables

## Implementation Plan:

1. Create database migrations for new schema
2. Build ingestion API at `/api/admin/articles/ingest` with dry_run parameter
3. Implement WebFetch for URL content extraction
4. Create rankings calculation service
5. Build rollback mechanism for deletions
6. Update UI with article management page

## Tech Stack:
- PostgreSQL (Neon) for database
- Drizzle ORM for migrations
- Next.js API routes
- OpenRouter for AI analysis

Please implement this system following the existing patterns in the codebase. The database is already configured and connected.

TEST YOUR IMPLEMENTATION by:
- Dry run on a test article
- Complete submission with rankings changes
- Delete and verify rollback works
- Update text without affecting rankings